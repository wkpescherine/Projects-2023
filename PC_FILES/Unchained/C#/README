Attempting to move code from Mac to PC after running into some issues.

With that in mind this C# code is an attempt to also convert from Java to C#
